# Домашнее задание 3. Классификация indoor/outdoor изображений с использованием CNN



**Задача:** Бинарная классификация изображений на категории "в помещении" (indoor) и "на улице" (outdoor) с использованием CNN.



## Описание проекта

Проект включает полный пайплайн решения задачи компьютерного зрения: от подготовки данных и аугментаций до обучения кастомной CNN-архитектуры и анализа ошибок.

## Датасет

Датасет включает в себя изображения внутри помещения (метка 0) и снаружи помещения (метка 1).

Характеристики датасета:
___
- Train indoor samples count: 144775 elements;
- Train outdoor samples count: 142557 elements;
- Train samples count: 287332 elements.
___
- Validation indoor samples count: 34514 elements;
- Validation outdoor samples count: 27082 elements;
- Validation samples count: 61596 elements.
___
- Test indoor samples count: 36000 elements;
- Test outdoor samples count: 25596 elements;
- Test samples count: 61596 elements.
___
Distribution of the proportions percentage ratios:
- train: 69.992 percent,
- val: 15.004 percent,
- test: 15.004 percent.
___
Number of batches (batch_size=29):
- train: 9908.0 batches,
- val: 2124.0 batches,
- test: 2124.0 batches.



## Собственная архитектура модели

```

ImageCNN:

Conv2d(3→32) → SiLU → MaxPool2d

Conv2d(32→64) → SiLU → MaxPool2d

Conv2d(64→128) → SiLU → MaxPool2d

Conv2d(128→256) → SiLU → MaxPool2d

Conv2d(256→512) → SiLU → MaxPool2d

Conv2d(512→1024) → SiLU → MaxPool2d

Linear(16384 → 1024) → SiLU → Dropout(0.5)

Linear(1024 → 512) → SiLU

Linear(512 → 1) → Sigmoid

```



## Ключевые результаты

- График обучения:

![Training log](https://radika1.link/2026/02/07/SNIMOK-EKRANA-2026-02-07-155833439cc304d6b17354.png)

- **Accuracy на тесте:** 94.9% (цель ≥ 95% практически достигнута)

- **F1-score:** 0.94

- **Количество параметров:** 23 591 745

- **Время обучения:** 50 эпох



## Методы улучшения качества



### Аугментации данных:

1. **RandomCrop + RandomHorizontalFlip + Resize** (Crop до 160px + горизонтальный переворот с вероятностью 0.75 с последующим масштабированием):

![1](https://radika1.link/2026/02/07/1785f0d4e360fb4a4.jpg)

2. **RandomRotation** (±60 градусов):

![2](https://s3.radikal.cloud/2026/02/07/22fe22e40de8b7072.jpg)

3. **RandomErasing** (вырезание случайных областей)

![3](https://s1.radikal.cloud/2026/02/07/317c34ccd6bdd693e.jpg)



### Архитектурные решения:

- **SiLU активация** вместо ReLU (лучшая регуляризация)

- **Глубокая CNN** с постепенным увеличением каналов (32→1024)

- **Dropout (0.5)** в полносвязных слоях для регуляризации

- **Нормализация данных** через стандартные трансформации PyTorch



## Анализ ошибок

Модель демонстрирует признаки переобучения (излишней уверенности в неправильных ответах) после 6-й эпохи:

- **Ложные паттерны:** Связывает светлые тона с outdoor, тёмные с indoor

- **Проблемные случаи:** Ночные сцены, переходные помещения, неправильная разметка

- **Критические ошибки:** 12 из 15 ошибок связаны с неоднозначными сценами



## Технические детали

- **Фреймворк:** PyTorch

- **Оптимизатор:** Adam (lr=0.0002)

- **Функция потерь:** Binary Cross Entropy

- **Размер батча:** 464

- **Разделение данных:** 70%/15%/15% (train/val/test)



## Основные выводы

1. **Комбинация аугментаций** критически важна для достижения 95% accuracy

2. **Качество ограничено** качеством разметки и неоднозначностью семплов

3. **Глубокая архитектура** (6 свёрточных слоев) эффективна для задачи



Домашнее задание демонстрирует полный цикл решения задачи классификации изображений с глубоким анализом ошибок и практическими инсайтами по улучшению моделей.