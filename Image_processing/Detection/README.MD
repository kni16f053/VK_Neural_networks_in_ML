# Домашнее задание 6. Детекция объектов: дообучение Faster R-CNN на новом классе



**Задача:** Дообучить предобученную модель детекции Faster R-CNN (COCO) на новом классе "бабочка" и исследовать влияние аугментаций на качество.



## Описание проекта

Дообучение модели Faster R-CNN с архитектурой ResNet50-FPN на классе, отсутствующем в оригинальном датасете COCO. Исследовано влияние различных типов аугментаций на качество детекции.



## Ключевые компоненты



### 1. Датасет

- **Название:** Open Images V7 (класс "Butterfly")

- **Объем:** 4000 тренировочных и 200 валидационных изображений

- **Формат:** Pascal VOC (bounding boxes)



### 2. Реализованные аугментации

- **Simple augs:** Яркость/контраст, Gaussian noise/blur (без изменения bbox)

- **Hard augs:** Аффинные преобразования, горизонтальные отражения (с трансформацией bbox)

- **All augs:** Все типы аугментаций вместе



### 3. Архитектура модели

- **Базовый детектор:** Faster R-CNN с ResNet50-FPN

- **Изменения:** Замена классификатора head для 2 классов (фон + бабочка)

- **Обучение:** Fine-tuning Region Proposal Network и классификатора



## Результаты экспериментов



### Качество детекции (mAP на валидации):

![Validation Loss](https://radika1.link/2026/02/07/SNIMOK-EKRANA-2026-02-07-112325dd5f0236e9409757.png)



### Ключевые наблюдения:

1. **Сложные аугментации (Hard)** дают наибольший прирост качества за 10 эпох

2. **Комбинированные аугментации (All)** показывают лучший результат среди всех на 4-й эпохе

3. **Простые аугментации (Simple)** помогают, но менее эффективны



## Технические особенности



### Реализованные функции:

- `DetectionDataset` - кастомный класс датасета для детекции

- `CalculateAP` - вычисление Average Precision с нуля

- Полный пайплайн обучения с валидацией

- Визуализация предсказаний



### Стек технологий:

- PyTorch, TorchVision

- Albumentations (аугментации)

- FiftyOne (загрузка Open Images)

- OpenCV, Matplotlib



## Основные выводы

1. **Fine-tuning** предобученной модели эффективен для новых классов

2. **Аугментации с трансформацией bbox** критически важны для детекции

3. **Порог уверенности** требует эмпирической настройки для каждого случая

4. **Качество детекции** улучшается с увеличением разнообразия данных



Домашнее задание демонстрирует полный цикл решения задачи детекции объектов: от подготовки данных и аугментаций до обучения модели и анализа результатов.